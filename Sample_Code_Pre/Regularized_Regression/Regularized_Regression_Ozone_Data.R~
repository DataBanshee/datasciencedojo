###################################################################################
## This code is part of Data Science Dojo's bootcamp
## Copyright (C) 2015

## Objective: Machine learning on ozone prediction with regularized linear regression model
## Data source: ozone data set (included in R)	
## Please install "ridge" package: install.packages("ridge")
## Please install "ridge" package: install.packages("miscTools")
###################################################################################

## DATA EXPLORATION
## load the library
library(ridge)
library(MASS)
library(miscTools)
## load the ozone data to R
ozone.data <- read.table("Ozone/ozone.data", header=T)
str(ozone.data)
## visualize the data
plot(ozone.data)      

## BUILD MODEL
## randomly choose 80% of the data set as training data
set.seed(777)
random.rows.train <- sample(1:nrow(ozone.data), 0.8*nrow(ozone.data), replace=F)
ozone.train <- ozone.data[random.rows.train,]
dim(ozone.train)
## select the other 20% as the testing data
random.rows.test <- setdiff(1:nrow(ozone.data),random.rows.train)
ozone.test <- ozone.data[random.rows.test,]
dim(ozone.test)
## fitting decision model on training set 
## ozone.model <- linearRidge(ozone~., ozone.train, lambda = 0)
ozone.model <- lm.ridge(ozone~., ozone.train, lambda = 0)
## ozone.model <- lm(ozone~., data=ozone.train)
ozone.model

## MODEL EVALUATION
## predict using linear regression model
ozone.test.predictions <- predict(ozone.model, ozone.test)
## define error
error <- ozone.test$ozone - ozone.test.predictions
## calculate Root Mean Squared Error (RMSE)
ozone.rmse <- sqrt(mean(error^2))
ozone.rmse
## calculate Mean Absolute Error (MAE)
ozone.mae <- mean(abs(error))
ozone.mae
## R squared (coefficient of determination)
resid <- ozone.test.predictions - ozone.test$ozone
r2 <- rSquared(ozone.test.predictions, resid)
r2

## EXERCISE
